# BOM

浏览器对象模型：Browser Object Model

控制浏览器显示页面以外的部分。

## window

看做是浏览器对`global`对象的实现放在了 window 中

global 是 window 的子集

### open 和 close

close 只能关闭 windows.open 打开的页面，否则无效。浏览器会警告

### window.self/self

只读属性，指向 window 本身

## 延时

### setTimeout/clearTimeout

```js
var foo = function() {}
setTimeout(foo, 1000)
//取消调用foo
var timeoutID = setTimeout(foo, 1000)
clearTimeout(timeoutID)
```

### setInterval/clearInterval

尽可能用 setTimeOut 代替，setInterval 可能会提前进入下一次

更多内容见单线程与异步编程

### 函数节流

某些函数不可以在没间断的情况下连续重复执行

比如 onresize 的时候进行大量的 DOM 计算，很容易引起崩溃

#### 简单版 throttle

```js
let obj = {
  id: null,
  process() {
    clearTimeout(this.id)
    const that = this
    that.id = setTimeout(() => {
      that.realAction()
    }, 100)
  },
  realAction() {
    console.log(1)
  }
}
obj.process()
obj.process()
obj.process() //100毫秒内只会执行1次
```

### 防抖

在触发事件后 n 秒再执行。不断触发以最后的一次为准

## location

既是 window 的属性，又是 document 的属性

document.location 等于 window.location

### replace(url)

改变浏览器的位置，但不会生成新纪录

假设一开始空白页，输入地址是百度，生成新纪录跳转到谷歌。按后退回到百度

不生成新纪录跳到谷歌，后退返回空白页

### reload()

重新加载当前页面

## history

### go()

history.go(-1)//后退一页

history.go(2)//前进 2 页

### back()

等于.go(-1)

### forward()

等于.go(1)

### 历史状态管理

#### hashchange

window 的事件（document 不触发），哈希值`#`改变后触发

hash 不会被包括在 HTTP 请求中。它是用来指导浏览器动作的，对服务器端完全无用，因此，改变 hash 不会重新加载页面

#### pushState

不加载新页面的情况下改变 url

history.pushState(state, title, url)

- state 是个对象。用于 onpopstate 接收

- title 目前所有浏览器都不生效，可以忽略。

- url 不能跨域

#### popstate 事件

只有访问其他页面再返回或者调方法才会触发 popstate

![](../images/3764d1ac6d473cef3891e4619212e3bb.png)

### replaceState

替换当前记录

## navigator

识别浏览器

### 属性 geolocation

地理位置。要求是 HTTPS

## screen
