(window.webpackJsonp=window.webpackJsonp||[]).push([[68],{566:function(t,s,a){t.exports=a.p+"assets/img/c791cbf7dcb1e7ec8a5424a617eddca2.c791cbf7.png"},567:function(t,s){t.exports="data:image/png;base64,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"},867:function(t,s,a){"use strict";a.r(s);var n=a(14),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"http"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http"}},[t._v("#")]),t._v(" http")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"createserver"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#createserver"}},[t._v("#")]),t._v(" createServer()")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 服务端")]),t._v("\nhttp\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("method"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//请求的方式，比如GET, POST")]),t._v("\n    res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hello, world"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8888")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("通过 "),s("code",[t._v("curl")]),t._v(" 可以查看请求的过程")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" http://127.0.0.1:8888\n")])])]),s("p",[t._v("内容如下")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("* Rebuilt URL to: http://127.0.0.1:8888/             # 三次握手开始\n*   Trying 127.0.0.1...\n* TCP_NODELAY set\n* Connected to 127.0.0.1 (127.0.0.1) port 8888 (#0)  # 三次握手结束\n> GET / HTTP/1.1                                     # 发送请求报文\n> Host: 127.0.0.1:8888\n> User-Agent: curl/7.55.1\n> Accept: */*\n>\n< HTTP/1.1 200 OK                                    # 服务器响应\n< Date: Sun, 07 Jun 2020 07:24:01 GMT\n< Connection: keep-alive\n< Content-Length: 12\n<\nhello, world\n* Connection #0 to host 127.0.0.1 left intact        # 会话结束\n")])])]),s("h2",{attrs:{id:"request"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#request"}},[t._v("#")]),t._v(" request")]),t._v(" "),s("p",[t._v("对应上面的"),s("code",[t._v("req")]),t._v(", req 是"),s("code",[t._v("http.IncomingMessag")]),t._v("实例")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("> GET / HTTP/1.1\n")])])]),s("p",[t._v("比如这一行的内容就表示 req.method 是 "),s("code",[t._v("GET")]),t._v("，req.url 是 "),s("code",[t._v("/")]),t._v("，req.httpVersion 是 "),s("code",[t._v("1.1")])]),t._v(" "),s("h3",{attrs:{id:"method-属性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#method-属性"}},[t._v("#")]),t._v(" method 属性")]),t._v(" "),s("p",[t._v("req.method"),s("br"),t._v("\n请求方式")]),t._v(" "),s("ul",[s("li",[t._v("GET")]),t._v(" "),s("li",[t._v("POST：如果 "),s("code",[t._v("req.method")]),t._v(" 是 post，通过调用"),s("a",{attrs:{href:"#on%E6%96%B9%E6%B3%95"}},[t._v("on 方法")]),t._v("监听数据")])]),t._v(" "),s("h3",{attrs:{id:"url-属性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#url-属性"}},[t._v("#")]),t._v(" url 属性")]),t._v(" "),s("p",[t._v("浏览器上的完整地址，可以用"),s("RouterLink",{attrs:{to:"/nodejs/009_query_string.html"}},[t._v("querystring")]),t._v("模块解析")],1),t._v(" "),s("h3",{attrs:{id:"headers-属性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#headers-属性"}},[t._v("#")]),t._v(" headers 属性")]),t._v(" "),s("p",[t._v("请求头，比如")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"content-type"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"on-方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#on-方法"}},[t._v("#")]),t._v(" on 方法")]),t._v(" "),s("p",[t._v("采用 Stream 的方式")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("http"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("method "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"POST"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" postData "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"data"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("chunk")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      postData "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" chunk"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"end"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"post数据接收完毕"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"pipe-方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pipe-方法"}},[t._v("#")]),t._v(" pipe 方法")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("将 req 的内容写到 res 中，等价于 req.on+req.end。")]),t._v(" "),s("p",[t._v("但 pipe 使用了流(stream)的方式，读取大文件更加高效")]),t._v(" "),s("h2",{attrs:{id:"response"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#response"}},[t._v("#")]),t._v(" response")]),t._v(" "),s("p",[t._v("res 是"),s("code",[t._v("http.ServerResponse")]),t._v("实例")]),t._v(" "),s("p",[t._v("http 模块会自动设置一些头信息，比如")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("< Date: Sun, 07 Jun 2020 07:24:01 GMT\n< Connection: keep-alive\n< Content-Length: 12\n")])])]),s("p",[t._v("res.setHeader 和 res.writeHead 写报文头\nres.write 和 res.end 写报文体"),s("br"),t._v("\nend 会先调用 write 并结束响应")]),t._v(" "),s("h3",{attrs:{id:"setheader-方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#setheader-方法"}},[t._v("#")]),t._v(" setHeader 方法")]),t._v(" "),s("p",[t._v("设置返回的响应头(Response Headers)，比如 content-type")]),t._v(" "),s("p",[t._v("只能设置单个状态\n"),s("code",[t._v("res.setHeader(key, value);")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("http"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Content-Type"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"application/json"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('{\n    hello: "world"\n  }')]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"set-cookie"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#set-cookie"}},[t._v("#")]),t._v(" Set-Cookie")]),t._v(" "),s("p",[t._v('服务器设置 cookie 的 key 是"Set-Cookie"')]),t._v(" "),s("p",[t._v("设置后 JS 内可以通过 document.cookie 查看，也可以看浏览器 Application 的 Cookies")]),t._v(" "),s("p",[s("img",{attrs:{src:a(566),alt:""}})]),t._v(" "),s("ol",[s("li",[t._v("path")])]),t._v(" "),s("p",[t._v("做登录功能要设置 path")]),t._v(" "),s("p",[t._v('例如在访问/foo/bar 时 Set-Cookie 的值只传了"key=value"，那么默认 path 是/foo/bar。这样在访问/foo/bar2 的时候 cookie 就会失效')]),t._v(" "),s("p",[t._v("实际上需求是要访问整个项目的时候都设置 cookie")]),t._v(" "),s("p",[t._v('res.setHeader("Set-Cookie", `username=hello; path=/`)')]),t._v(" "),s("p",[s("img",{attrs:{src:a(567),alt:""}})]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[t._v("httpOnly")])]),t._v(" "),s("p",[t._v("只允许后台修改 cookie")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Set-Cookie"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("username=hello; httpOnly")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("前后端都可以设置，设置后 document.cookie 不包含，也无法修改")]),t._v(" "),s("p",[t._v("3.expires")]),t._v(" "),s("p",[t._v("过期时间，格式是 GMT 的字符串")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" date "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Date")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("toGMTString")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nres"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Set-Cookie"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("username=hello; expires=")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("date"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"writehead"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#writehead"}},[t._v("#")]),t._v(" writeHead")]),t._v(" "),s("p",[t._v("多个返回的响应头(Response Headers)")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeHead")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("statusCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("key")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("key2")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" value2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nres"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeHead")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"Content-Type"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"text/plain"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nres"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("hello, world")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"end-方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#end-方法"}},[t._v("#")]),t._v(" end 方法")]),t._v(" "),s("h2",{attrs:{id:"http-request"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http-request"}},[t._v("#")]),t._v(" http.request")]),t._v(" "),s("p",[t._v("构造客户端以发送请求")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nhttp\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("host")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"127.0.0.1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("port")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8888")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("path")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("method")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"GET"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("res")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"data"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// "hello, world"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("请求发送和浏览器一样存在限制，最多发送 5 个。")])])}),[],!1,null,null,null);s.default=e.exports}}]);