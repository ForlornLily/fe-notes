(window.webpackJsonp=window.webpackJsonp||[]).push([[209],{727:function(s,t,a){"use strict";a.r(t);var n=a(14),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"子-shell"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#子-shell"}},[s._v("#")]),s._v(" 子 shell")]),s._v(" "),t("h2",{attrs:{id:"创建"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建"}},[s._v("#")]),s._v(" 创建")]),s._v(" "),t("ol",[t("li",[s._v("通过 "),t("code",[s._v("/bin/dash")]),s._v(" 启动 bash shell，然后再输入 "),t("code",[s._v("bash")]),s._v(" 就会启动一个子 shell，输入 "),t("code",[s._v("exit")]),s._v(" 退出"),t("br"),s._v("\n可以通过"),t("code",[s._v("ps -f")]),s._v(" 查看进程列表")]),s._v(" "),t("li",[s._v("括号包裹 shell 命令，会自动创建子 Shell")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xxx ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ps -f")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("UID")]),s._v("        PID  "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PPID")]),s._v("  C STIME TTY          TIME CMD\nroot     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23714")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23712")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":17 pts/0    00:00:00 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-bash")]),s._v("\nroot     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23734")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23714")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":18 pts/0    00:00:00 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xxx ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# (sleep 10)")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 10秒内输入内容无法执行, 10秒后会执行")]),s._v("\n")])])]),t("ol",{attrs:{start:"3"}},[t("li",[s._v("协程 "),t("code",[s._v("coproc")]),s._v("，创建子 shell 并使用后台模式，还可以给子 shell 取名")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xxx ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# coproc sleep 10")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("24012")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xxx ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ps -f")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("UID")]),s._v("        PID  "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PPID")]),s._v("  C STIME TTY          TIME CMD\nroot     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23714")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23712")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":17 pts/0    00:00:00 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-bash")]),s._v("\nroot     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("24012")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23714")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":33 pts/0    00:00:00 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\nroot     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("24013")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23714")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":33 pts/0    00:00:00 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v("\n")])])]),t("p",[s._v("取名需要用 "),t("code",[s._v("{}")]),s._v(" 包括命令，并用 "),t("code",[s._v(";")]),s._v(" 表示结束")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xxx ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# coproc test { sleep 10 ;}")]),s._v("\n")])])]),t("ol",{attrs:{start:"4"}},[t("li",[t("a",{attrs:{href:"#%E5%A4%96%E9%83%A8%E5%91%BD%E4%BB%A4"}},[s._v("外部命令")])])]),s._v(" "),t("h2",{attrs:{id:"后台模式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#后台模式"}},[s._v("#")]),s._v(" 后台模式")]),s._v(" "),t("p",[s._v("创建子 shell 可以使用后台模式：也就是在后台处理命令，把当前的输入让给其他用。"),t("br"),s._v("\n如果想要变成后台模式，在命令后面加 "),t("code",[s._v("&")]),t("br"),s._v("\n括号创建，则在括号后面加："),t("code",[s._v("(sleep 10) &")])]),s._v(" "),t("h2",{attrs:{id:"sleep"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sleep"}},[s._v("#")]),s._v(" sleep")]),s._v(" "),t("p",[s._v("暂停一段时间，以秒为单位")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令执行后的第一行内容分别是后台作业号（background job）和进程 ID")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xxx bin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sleep 10 &")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23399")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xxx bin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ps -f")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("UID")]),s._v("        PID  "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PPID")]),s._v("  C STIME TTY          TIME CMD\nroot     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23216")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23214")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":41 pts/0    00:00:00 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-bash")]),s._v("\nroot     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23255")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23216")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":44 pts/0    00:00:00 /bin/bash\nroot     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23331")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23255")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":49 pts/0    00:00:00 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v("\nroot     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23399")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23331")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":56 pts/0    00:00:00 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\nroot     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23400")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23331")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":56 pts/0    00:00:00 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v("\n")])])]),t("p",[s._v("10 秒以后")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xxx bin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ps -f")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("UID")]),s._v("        PID  "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PPID")]),s._v("  C STIME TTY          TIME CMD\nroot     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23216")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23214")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":41 pts/0    00:00:00 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-bash")]),s._v("\nroot     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23255")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23216")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":44 pts/0    00:00:00 /bin/bash\nroot     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23331")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23255")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":49 pts/0    00:00:00 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v("\nroot     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23411")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23331")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":56 pts/0    00:00:00 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("+  Done                    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n")])])]),t("h2",{attrs:{id:"jobs"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jobs"}},[s._v("#")]),s._v(" jobs")]),s._v(" "),t("p",[s._v("显示所有后台作业")]),s._v(" "),t("h2",{attrs:{id:"相关变量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#相关变量"}},[s._v("#")]),s._v(" 相关变量")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("$BASH_SUBSHELL")])])]),s._v(" "),t("h2",{attrs:{id:"外部与内建命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#外部与内建命令"}},[s._v("#")]),s._v(" 外部与内建命令")]),s._v(" "),t("p",[s._v("判断内外可以用 "),t("code",[s._v("type")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xxx ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# type ps")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" is /usr/bin/ps\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xxx ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# type cd")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" is a shell "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("builtin")]),s._v("\n")])])]),t("h3",{attrs:{id:"外部命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#外部命令"}},[s._v("#")]),s._v(" 外部命令")]),s._v(" "),t("p",[s._v("也被称为文件系统命令"),t("br"),s._v("\n存在于 bash shell 程序之外的命令，并不属于 shell。比如 "),t("code",[s._v("ps")]),t("br"),s._v("\n通过 "),t("code",[s._v("which")]),s._v(" 或者 "),t("code",[s._v("type")]),s._v(" 查看所在位置"),t("br"),s._v("\n一般位于 "),t("code",[s._v("/bin")]),s._v("，"),t("code",[s._v("/usr/bin")]),s._v("，"),t("code",[s._v("/sbin")]),s._v("或者 "),t("code",[s._v("/usr/bin")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xxx ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# which ps")]),s._v("\n/usr/bin/ps\n")])])]),t("p",[s._v("外部命令会创建一个子进程，这种操作称之为 "),t("code",[s._v("forking")]),s._v("（衍生）"),t("br"),s._v("\n大致过程是 父进程发出命令 "),t("code",[s._v("ps")]),s._v(" → 创建子进程 → 子进程执行命令")]),s._v(" "),t("h3",{attrs:{id:"内建命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#内建命令"}},[s._v("#")]),s._v(" 内建命令")]),s._v(" "),t("p",[s._v("不会创建子进程")]),s._v(" "),t("h3",{attrs:{id:"混合"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#混合"}},[s._v("#")]),s._v(" 混合")]),s._v(" "),t("p",[s._v("有些命令既有内建，也有外部实现。\n可以通过 "),t("code",[s._v("type -a")]),s._v(" 查看")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xxx ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# type -a echo")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" is a shell "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("builtin")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" is /usr/bin/echo\n\n")])])]),t("p",[s._v("默认使用内建命令"),t("br"),s._v("\n如果要用外部实现，通过路径指定即可，如 "),t("code",[s._v('/usr/bin/echo "hello"')])])])}),[],!1,null,null,null);t.default=e.exports}}]);